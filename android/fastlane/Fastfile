fastlane_require 'dotenv'

before_all do
  Dotenv.overload('.env')
end

# platform :android do
#     desc "Weather  Forecast"
#     lane :firebase_deploy do
#         gradle(task: 'clean assembleRelease', project_dir: './android', print_command: false, properties: {
#           "MYAPP_UPLOAD_STORE_FILE" => ENV["UPLOAD_STORE_FILE"],
#           "MYAPP_UPLOAD_STORE_PASSWORD" => ENV["UPLOAD_STORE_PASSWORD"],
#           "MYAPP_UPLOAD_KEY_ALIAS" => ENV["UPLOAD_KEY_ALIAS"],
#           "MYAPP_UPLOAD_KEY_PASSWORD" => ENV["UPLOAD_KEY_PASSWORD"]
#         })

platform :android do
    desc "Weather  Forecast"
    lane :firebase_deploy do
      gradle(task: "clean assembleRelease")
      # Ensure FIREBASE_APP_ID is set in your environment variables
      if ENV["APP_ID_FIREBASE"].nil?
        UI.user_error!("APP_ID_FIREBASE environment variable is not set.")
      end
      # Ensure FIREBASE_APP_ID is set in your environment variables
      if ENV["FIREBASE_CLI_TOKEN"].nil?
        UI.user_error!("FIREBASE_CLI_TOKEN environment variable is not set.")
      end

    firebase_app_distribution(
      app: ENV["APP_ID_FIREBASE"],
      testers: ENV["FIREBASE_TESTERS_GROUPS"],
      groups: "Testers", # Optional: distribute to groups
      firebase_cli_token: ENV["FIREBASE_CLI_TOKEN"],
      release_notes: "Lots of amazing new features to test out!"
    )

    end
  end